{"v": 1, "slug": "kg-web", "title": "kg Web Viewer", "type": "concept", "created_at": "2026-02-20T09:58:21.099996+00:00"}
{"id": "b-ae9c1a0b", "type": "fact", "text": "kg web index page uses SQLite SELECT (slug, title, type, bullet_count) instead of iter_nodes() \u2014 avoids reading every node.jsonl; O(1) DB query vs O(N) file reads", "created_at": "2026-02-20T09:58:21.100322+00:00"}
{"id": "b-956a5398", "type": "fact", "text": "kg web _get_slugs_db(): SELECT slug FROM nodes \u2014 replaces FileStore.list_slugs() (iterdir + stat per dir) on every node and search page request", "created_at": "2026-02-20T09:58:21.100506+00:00"}
{"id": "b-c1b6898c", "type": "fact", "text": "kg web lazy Related section: node page renders <div id='kg-related'> placeholder + inline JS fetch('/api/related/<slug>'); page returns instantly, related loads async", "created_at": "2026-02-20T09:58:21.100679+00:00"}
{"id": "b-fc63f700", "type": "fact", "text": "/api/related/<slug> route: returns raw HTML fragment (no page wrapper); builds related via _related_html() after node page has already been sent to browser", "created_at": "2026-02-20T09:58:21.100840+00:00"}
{"id": "b-b319985c", "type": "fact", "text": "backlinks section (_backlinks_html) stays synchronous \u2014 it's fast (single DB query + read a few JSONL files); only Related is lazy (vector+FTS+reranker is the slow part)", "created_at": "2026-02-20T09:58:21.100986+00:00"}
{"id": "b-60370e13", "type": "fact", "text": "Search results page: doc results separated from concept node results, shown in collapsible 'Show N source file results' section (same docs-toggle-btn pattern as index page). Concept results show [[slug]] title format; doc results show <code>path</code> format.", "created_at": "2026-02-20T10:57:19.602737+00:00"}
{"id": "b-15ac3f37", "type": "fact", "text": "/agents page (agents tab): client-side filter input; TOML status badges (ag-paused=yellow, ag-draining=blue); pause/drain/resume control buttons on each card (form POST to /agent/<name>/ctrl); pending count from messages_db (not mux.db). _mux_agents() now merges runtime state from mux.db + TOML defs + messages.db counts. [[kg-agent-mux]]", "created_at": "2026-02-22T06:40:38.768026+00:00"}
{"id": "b-da2746a8", "type": "fact", "text": "/agent/<name> page: info bar (runtime status + TOML status + node + model), control buttons (pause/drain/resume form-POST to /ctrl), message thread from messages_db (fixed \u2014 was querying removed mux.db messages table), urgent checkbox in send form, auto-refresh every 8s via JS fetch (only when running, updates thread innerHTML without resetting scroll). [[kg-agent-mux]]", "created_at": "2026-02-22T06:40:42.220258+00:00"}
{"id": "b-02bcd45e", "type": "fact", "text": "POST /agent/<name>/ctrl route: accepts action=(pause|resume|drain) form field, calls update_agent_def() to write status to .kg/agents/<name>.toml, redirects back to agent page. POST /agent/<name>/message now accepts urgent= form field (checkbox) to send as urgency=urgent to mux. [[kg-agent-mux]] [[kg-agent-launcher]]", "created_at": "2026-02-22T06:40:46.870337+00:00"}
{"id": "b-caa6c122", "type": "fact", "text": "/agent/<name> page improvements: info bar (runtime status badge, TOML status badge if paused/draining, node, model, last_seen); pause/drain/resume control buttons (form POSTs to /agent/<name>/ctrl); msg thread from messages.db (fixed \u2014 was querying dead mux.db messages table); urgent checkbox on send form (button turns red); fetch-based auto-refresh every 8s only when agent status=running (updates thread innerHTML, preserves scroll). [[kg-agent-mux]]", "created_at": "2026-02-22T06:48:27.453384+00:00"}
{"id": "b-1bc57c28", "type": "fact", "text": "/agents page improvements: client-side filter input (JS, hides cards whose data-name doesn't match); TOML status badges (ag-paused=yellow, ag-draining=blue, only when non-running); pause/drain/resume buttons per card; pending count from messages.db not mux.db. _mux_agents() merges: mux.db (runtime status/last_seen) + .kg/agents/*.toml (toml_status/node/model) + messages.db (pending count). [[kg-agent-mux]]", "created_at": "2026-02-22T06:48:34.510723+00:00"}
{"id": "b-af29e02b", "type": "fact", "text": "POST /agent/<name>/ctrl route: action=pause|resume|drain. Calls update_agent_def(cfg, name, status=...) to write TOML. Status map: pause\u2192paused, resume\u2192running, drain\u2192draining. Redirects back to /agent/<name>. Launcher picks up change via inotify or next poll.", "created_at": "2026-02-22T06:48:40.134048+00:00"}
